# template-toc [![NPM version](https://badge.fury.io/js/template-toc.svg)](http://badge.fury.io/js/template-toc)  [![Build Status](https://travis-ci.org/jonschlinkert/template-toc.svg)](https://travis-ci.org/jonschlinkert/template-toc)

> Middleware for generating a markdown Table of Contents with Template or applications based on Template.

## Install with [npm](npmjs.org)

```bash
npm i template-toc --save
```

## Table of Contents

_(Generated by [verb] using this middleware)_

<!-- toc -->

- [Usage](#usage)
  * [Two Steps](#two-steps)
  * [Usage with Template](#usage-with-template)
  * [Usage with Verb](#usage-with-verb)
  * [Usage with Assemble](#usage-with-assemble)
- [Pro-tip](#pro-tip)
- [Related projects](#related-projects)
- [Running tests](#running-tests)
- [Contributing](#contributing)
- [Author](#author)
- [License](#license)

_(Table of contents generated by [verb])_

<!-- tocstop -->

## Usage

```js
var toc = require('template-toc');
```

### Two Steps

**1. [Register the middleware](#usage-with-template)**

Register with [template], [verb], [assemble] or any other application that implements [template].


**2. Add a TOC marker**

Add the following to any markdown file that should get a Table of Contents:

```html
<!-- toc -->
```

### Usage with Template

```js
var Template = require('template');
var template = new Template();
```

**Pre-render middleware**

If you want the TOC to be generated before layouts are used or partials are injected into pages, use the `.preRender()` method. 

```js
template.preRender(/\.md$/, toc(template));
```

This project's [verbfile](./.verb.md) is a good example. Verb uses this middleware with `.preRender()` so that the generated TOC only includes "top-level" headings that are in the template, and none of the headings from partials are includes.


**Post-render middleware**

If you want the TOC to be generated **after** layouts are used or partials are injected into pages, use the `.postRender()` method. 

```js
template.postRender(/\.md$/, toc(template));
```

**Rendering templates**

Once the middlware is setup, any templates with a `.md` extension and a `<!-- toc -->` comment will have a TOC injected.

```js
template.render('README.md', function(err, content) {
  console.log(content);
});
```
Visit [template] for documentation.


### Usage with Verb

```js
var verb = require('verb');
verb.preRender(/\.md$/, toc(verb));
// or 
verb.postRender(/\.md$/, toc(verb));
```

Visit [verb] for documentation.

### Usage with Assemble

```js
var assemble = require('assemble');
assemble.preRender(/\.md$/, toc(assemble));
// or 
assemble.postRender(/\.md$/, toc(assemble));
```

Visit [assemble] for documentation.

## Pro-tip

**Escaping**

If, for some reason, you need to use the `<!- toc -->` comment in documentation and you do not want it to be rendered, just add an extra `!` after the first angle bracket, and the extra `!` will be removed but the TOC will not be rendered.

```html
<!-- toc -->
```

## Related projects
* [markdown-toc](https://github.com/jonschlinkert/markdown-toc): Generate a markdown TOC (table of contents) with Remarkable.
* [markdown-utils](https://github.com/jonschlinkert/markdown-utils): Micro-utils for creating markdown snippets.
* [remarkable](https://github.com/jonschlinkert/remarkable): Markdown parser, done right. 100% Commonmark support, extensions, syntax plugins,… [more](https://github.com/jonschlinkert/remarkable)
* [template](https://github.com/jonschlinkert/template): Render templates from any engine. Make custom template types, use… [more](https://github.com/jonschlinkert/template)
* [verb](https://github.com/assemble/verb): Verb makes it dead simple to generate markdown documentation, using… [more](https://github.com/assemble/verb)  

## Running tests
Install dev dependencies:

```bash
npm i -d && npm test
```

## Contributing
Pull requests and stars are always welcome. For bugs and feature requests, [please create an issue](https://github.com/jonschlinkert/template-toc/issues)

## Author
**Jon Schlinkert**

+ [github/jonschlinkert](https://github.com/jonschlinkert)
+ [twitter/jonschlinkert](http://twitter.com/jonschlinkert)

## License
Copyright (c) 2015 Jon Schlinkert  
Released under the MIT license

***

_This file was generated by [verb-cli](https://github.com/assemble/verb-cli) on April 23, 2015._

[verb]: https://github.com/assemble/verb
[assemble]: https://github.com/assemble/assemble
[template]: https://github.com/jonschlinkert/template